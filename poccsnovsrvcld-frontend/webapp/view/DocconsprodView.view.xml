<mvc:View xmlns:core="sap.ui.core" controllerName="poccsnovsrvcldfrontend.controller.DocconsprodView"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"
    xmlns="sap.m" xmlns:t="sap.ui.table"
    xmlns:rowmodes="sap.ui.table.rowmodes"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:f="sap.f"
    xmlns:sap.ui.fl="sap.ui.fl">
    <Panel expandable="true" expanded="true" headerText="Seleziona documenti di riferimento" 
           visible="true" class="sapUiSmallMarginBottom">
           <!-- MESSAGGIO DI ERRORE SE NON SI POPOLA NEMMENO UN FILTRO -->
        <MessageStrip id="filter-error-msg" text="Compilare almeno un filtro per avviare la ricerca"
            type="Information" showIcon="true" visible="false">
        </MessageStrip>
        <!-- BARRA DEI FILTRI -->
        <fb:FilterBar id= "filters-bar" useToolbar="false" search="onCerca">
            <fb:filterGroupItems>
                <fb:FilterGroupItem name="NumeroConsegna" label="N. Consegna" groupName="MultiComboBox" visibleInFilterBar="true">
                    <fb:control>
                        <MultiComboBox name="NumeroConsegna" items="{/NumeriConsegna}" fieldGroupIds="filtri-input">
                            <core:Item key="{key}" text="{name}" />
                        </MultiComboBox>
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem name="DataUM" label="Data UM" groupName="DateRangeSelection"
                    visibleInFilterBar="true">
                    <fb:control>
                        <DateRangeSelection name="DataUM" displayFormat="dd/MM/yyyy" placeholder=" " fieldGroupIds="filtri-input" />
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem name="NumeroOdv" label="N. OdV" groupName="MultiComboBox"
                    visibleInFilterBar="true">
                    <fb:control>
                        <MultiComboBox name="NumeroOdv" items="{/NumeriOdv}" fieldGroupIds="filtri-input">
                            <core:Item key="{key}" text="{name}" />
                        </MultiComboBox>
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem name="DataOdv" label="Data OdV" groupName="DateRangeSelection"
                    visibleInFilterBar="true">
                    <fb:control>
                        <DateRangeSelection name="DataOdv" displayFormat="dd/MM/yyyy" placeholder=" " fieldGroupIds="filtri-input" />
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem name="StatoUM" label="Stato UM" groupName="MultiComboBox"
                    visibleInFilterBar="true">
                    <fb:control>
                        <MultiComboBox name="StatoUM" items="{/StatiUM}" value="C - Elaborato completamente" enabled="false" fieldGroupIds="filtri-input">
                            <core:Item key="{key}" text="{name}" />
                        </MultiComboBox>
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem name="LuogoSpedizione" label="Luogo Sped." groupName="MultiComboBox"
                    visibleInFilterBar="true">
                    <fb:control>
                        <MultiComboBox name="LuogoSpedizione" items="{/LuoghiSpedizione}" fieldGroupIds="filtri-input">
                            <core:Item key="{key}" text="{name}" />
                        </MultiComboBox>
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem name="Materiale" label="Materiale" groupName="MultiComboBox"
                    visibleInFilterBar="true">
                    <fb:control>
                        <MultiComboBox name="Materiale" items="{/Materiali}" fieldGroupIds="filtri-input">
                            <core:Item key="{key}" text="{name}" />
                        </MultiComboBox>
                    </fb:control>
                </fb:FilterGroupItem>
            </fb:filterGroupItems>
        </fb:FilterBar>
        <!-- TABELLA DEI DOCUMENTI CORRISPONDENTI AI FILTRI -->
        <VBox visible="false">
            <t:Table id="filters-table" rows="{/MockData}" class="sapUiSmallMarginBottom"
                rowSelectionChange="rowSelectionChange" sort="onSort" columnResize="onColumnResize"
                columnMove="onColumnMove" sap.ui.fl:flexibility="sap/m/flexibility/EngineFlex">
                <t:rowMode>
                    <rowmodes:Fixed />
                </t:rowMode>
                <t:extension>
					<OverflowToolbar>
						<ToolbarSpacer />
						<Button icon="sap-icon://action-settings" press="openColumnSelection"/>
					</OverflowToolbar>
				</t:extension>
                <t:columns>
                    <t:Column id="numeroconsegna-col" sortProperty="NumeroConsegna">
                        <Label text="N. Consegna" />
                        <t:template>
                            <Text text="{NumeroConsegna}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="numeroodv-col" sortProperty="NumeroOdv">
                        <Label text="N. OdV" />
                        <t:template>
                            <Text text="{NumeroOdv}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="dataodv-col" sortProperty="DataOdv">
                        <Label text="Data OdV" />
                        <t:template>
                            <Text text="{path: 'DataOdv', type: 'sap.ui.model.type.Date', 
                                formatOptions: {pattern: 'dd/MM/yyyy'}}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="destinatariomerci-col" sortProperty="DestinatarioMerci">
                        <Label text="Destinatario Merci" />
                        <t:template>
                            <Text text="{DestinatarioMerci}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="indirizzodestinatariomerci-col" sortProperty="IndirizzoDestinatarioMerci">
                        <Label text="Indirizzo Destinatario Merci" />
                        <t:template>
                            <Text text="{IndirizzoDestinatarioMerci}" />
                        </t:template>
                    </t:Column>
                     <t:Column id="dataum-col" sortProperty="DataUM">
                        <Label text="Data UM" />
                        <t:template>
                            <Text text="{path: 'DataUM', type: 'sap.ui.model.type.Date', 
                                formatOptions: {pattern: 'dd/MM/yyyy'}}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="numerocolli-col" sortProperty="NumeroColli">
                        <Label text="N. Colli" />
                        <t:template>
                            <Text text="{NumeroColli}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="trasportatore-col" sortProperty="Trasportatore">
                        <Label text="Trasportatore" />
                        <t:template>
                            <Text text="{Trasportatore}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="luogospedizione-col" sortProperty="LuogoSpedizione">
                        <Label text="Luogo Sped." />
                        <t:template>
                            <Text text="{LuogoSpedizione}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="materiale-col" sortProperty="Materiale">
                        <Label text="Materiale" />
                        <t:template>
                            <Text text="{Materiale}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="quantita-col" sortProperty="Quantità">
                        <Label text="Quantità" />
                        <t:template>
                            <Text text="{Quantità}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="um-col" sortProperty="UM">
                        <Label text="UM" />
                        <t:template>
                            <Text text="{UM}" />
                        </t:template>
                    </t:Column>
                    <t:Column id="materialecliente-col" sortProperty="MaterialeCliente">
                        <Label text="Materiale Cliente" />
                        <t:template>
                            <Text text="{MaterialeCliente}" />
                        </t:template>
                    </t:Column>
                </t:columns>
            </t:Table>
            <HBox justifyContent="End">
                <Button text="Reset" class="sapUiSmallMarginEnd" width="5rem" press="onReset" />
                <Button id="seleziona-btn" text="Seleziona" width="5rem" type="Emphasized" enabled="false" press="onSeleziona"/>
            </HBox>
        </VBox>
    </Panel>
    <Panel id="riferimenti-panel" expandable="true" expanded="true" headerText="Documenti di riferimento" visible="false">
        <t:Table id="riferimenti-table" rows="{/Riferimenti}" selectionMode="None" sort="onSort" columnResize="onColumnResize"
                columnMove="onColumnMove" sap.ui.fl:flexibility="sap/m/flexibility/EngineFlex" class="sapUiMediumMarginBottom">
            <t:rowMode>
                <rowmodes:Fixed />
            </t:rowMode>
            <t:extension>
                <OverflowToolbar>
                    <ToolbarSpacer />
                    <Button icon="sap-icon://action-settings" press="openColumnSelection"/>
                </OverflowToolbar>
            </t:extension>
            <t:columns>
                <t:Column id="numeroconsegna-col-rif" sortProperty="NumeroConsegna">
                    <Label text="N. Consegna" />
                    <t:template>
                        <Text text="{NumeroConsegna}" />
                    </t:template>
                </t:Column>
                <t:Column id="numeroodv-col-rif" sortProperty="NumeroOdv">
                    <Label text="N. OdV" />
                    <t:template>
                        <Text text="{NumeroOdv}" />
                    </t:template>
                </t:Column>
                <t:Column id="dataodv-col-rif" sortProperty="DataOdv">
                    <Label text="Data OdV" />
                    <t:template>
                        <Text text="{path: 'DataOdv', type: 'sap.ui.model.type.Date', 
                            formatOptions: {pattern: 'dd/MM/yyyy'}}" />
                    </t:template>
                </t:Column>
                <t:Column id="destinatariomerci-col-rif" sortProperty="DestinatarioMerci">
                    <Label text="Destinatario Merci" />
                    <t:template>
                        <Text text="{DestinatarioMerci}" />
                    </t:template>
                </t:Column>
                <t:Column id="indirizzodestinatariomerci-col-rif" sortProperty="IndirizzoDestinatarioMerci">
                    <Label text="Indirizzo Destinatario Merci" />
                    <t:template>
                        <Text text="{IndirizzoDestinatarioMerci}" />
                    </t:template>
                </t:Column>
                    <t:Column id="dataum-col-rif" sortProperty="DataUM">
                    <Label text="Data UM" />
                    <t:template>
                        <Text text="{path: 'DataUM', type: 'sap.ui.model.type.Date', 
                            formatOptions: {pattern: 'dd/MM/yyyy'}}" />
                    </t:template>
                </t:Column>
                <t:Column id="numerocolli-col-rif" sortProperty="NumeroColli">
                    <Label text="N. Colli" />
                    <t:template>
                        <Text text="{NumeroColli}" />
                    </t:template>
                </t:Column>
                <t:Column id="trasportatore-col-rif" sortProperty="Trasportatore">
                    <Label text="Trasportatore" />
                    <t:template>
                        <Text text="{Trasportatore}" />
                    </t:template>
                </t:Column>
                <t:Column id="luogospedizione-col-rif" sortProperty="LuogoSpedizione">
                    <Label text="Luogo Sped." />
                    <t:template>
                        <Text text="{LuogoSpedizione}" />
                    </t:template>
                </t:Column>
                <t:Column id="materiale-col-rif" sortProperty="Materiale">
                    <Label text="Materiale" />
                    <t:template>
                        <Text text="{Materiale}" />
                    </t:template>
                </t:Column>
                <t:Column id="quantita-col-rif" sortProperty="Quantità">
                    <Label text="Quantità" />
                    <t:template>
                        <Text text="{Quantità}" />
                    </t:template>
                </t:Column>
                <t:Column id="um-col-rif" sortProperty="UM">
                    <Label text="UM" />
                    <t:template>
                        <Text text="{UM}" />
                    </t:template>
                </t:Column>
                <t:Column id="materialecliente-col-rif" sortProperty="MaterialeCliente">
                    <Label text="Materiale Cliente" />
                    <t:template>
                        <Text text="{MaterialeCliente}" />
                    </t:template>
                </t:Column>
                <t:Column id="azioni-rif" width="6rem" hAlign="Center">
                    <t:template>
                        <HBox justifyContent="SpaceAround">
                            <Button icon="sap-icon://delete" press="eliminaRiferimento"/>
                            <Button icon="sap-icon://inspection" type="Default" press="apriPdf" tooltip="Visualizza documento ODV_{NumeroOdv}.pdf"/>
                        </HBox>
                    </t:template>
                </t:Column>
            </t:columns>
        </t:Table>
        <VBox id="vbox-note">
            <Label id="label-note" text="Note" design="Bold"/>
            <TextArea id="text-area-note" ariaLabelledBy="label-note" width="100%" height="8rem" />
        </VBox>
    </Panel>
</mvc:View>